---
output:
  word_document: default
  html_document: default
---

### Assignment 1
#### Matt Graham

Defining and applying statistics

#### Data gathering

```{r}
source("http://www.openintro.org/stat/data/cdc.R")
```


### 1 - Scatterplots


```{r}
plot(
        x=cdc$height,
        y=cdc$weight,
        main='Weight v. Heigh regression',
        xlab = 'Height',
        ylab= 'Weight'
)
abline(lm(weight~height, data=cdc), col='red')
cor(cdc$height, cdc$weight)
```


We can see there is a general positive correlation between height and weight. This generally makes sense given taller people have more mass. We also have an R2 = 0.555, meaning it is not significant. We can understand why when observing the spread in our data.

### 2 - Desired vs. current weight

```{r}
plot(
        x=cdc$wtdesire,
        y=cdc$weight,
        main='Desired v. Current weight regression',
        xlab = 'Desired weight',
        ylab= 'Current weight'
)
abline(lm(weight~wtdesire, data=cdc), col='red')
cor(cdc$wtdesire, cdc$weight)
```

This is an interesting intersection of thought. The high correlation between the two, if not equal to 1, is fairly close given the dynamicism of weight. There are a few interesting outliers - like the person who desires to be over 600 lbs and is currently ~200.

#### Creating wdiff
```{r}
cdc$wdiff <- cdc$weight - cdc$wtdesire
hist(cdc$wdiff, breaks=50)
```

### 3 - wdiff analysis
If an observation = 0, that means that person is their goal weight. If wdiff is positive, this means they are above their goal weight. If wdiff is negative, it means they are below their goal weight.

### 4 - wdiff spread w/o outliers
Shown above, the spread is heavily spread with our outliers. Once we remove them, our spread

```{r}
quartiles <- quantile(cdc$wdiff, probs = c(.25, .75) , na.rm=FALSE)
iqr <- IQR(cdc$wdiff)

lower <- quartiles[1] - 1.5*iqr
upper <- quartiles[2] + 1.5*iqr

cdc_nol <- subset(cdc, cdc$wdiff > lower & cdc$wdiff < upper)
hist(cdc_nol$wdiff, breaks=50)
```

Once we break this down further, we can see how widespread this is. We may want to consider transforming this even further. Our center is near 0, spread is very wide - from over 40 to less than -20. A range over 60lbs is very wide in terms of variation from desired. It also tells us that people typically feel they are overweight. We also have a lot of people who are at their target weight. This is worth celebrating!


### 5 - wdiff boxplots and numerical analysis
#### Boxplot
```{r}
boxplot(cdc_nol$wdiff ~ cdc_nol$gender)

```
#### Numerical summary
```{r}
library(mosaic)
favstats(wdiff~gender, data = cdc_nol)
```

As we can see, once we removed all the outliers, desired v. actual differences between sex-assigned male and female are about equal in shape. Women tend to feel they're further from their goal than men by ~5lbs. This is interesting if we look at that proportionally as most sex-assigned women are lower weight than sex-assigned men.

### 6 - Finding weights w/in 1 standard deviation


```{r}
w_stats <- favstats(cdc_nol$weight, data = cdc_nol)

avg <- w_stats[1, "mean"]
sd <- w_stats[1, "sd"]

lower <- avg - sd
upper <- avg + sd

w_range <- c(lower, upper)
w_range
```

68% of our values fall within 1 standard deviation of our mean. The values for that are between ~130lbs and 200lbs. We can see how this range is greater than our 25th and 75th percentiles displayed below. This makes sense as we are now capturing ~68% of our sample's reported weight.


```{r}
quartiles <- quantile(cdc_nol$weight, probs = c(.25, .75) , na.rm=FALSE)
quartiles
```
