# a.rho
V.s <- tr(solve(E + H) %*% H)
a.rho <- V.s / s
sprintf("a.rho: %s", a.rho)
# a.lh
U.s <- tr(solve(E) %*% H)
a.lh <- (U.s / s) / (1 + (U.s / s))
sprintf("a.lh: %s", a.lh)
# See example 6.2
E ** -1
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
t(E)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
t(E)*H
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
eigen(t(E)*H)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
eigen(t(E)%*%H)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
eigen(E**-1%*%H)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
int(E)
# See example 6.2
inv(E)
# See example 6.2
t(E)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
t(E)%*%E
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
solve(E) %*% H
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
eigen(solve(E) %*% H)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
eigen(lambda.1)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
eigen(solve(E) %*% H)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: $l", vals)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: %l", vals)
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: %a", vals)
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: %s", vals)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: %s", vals[1])
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: %s", avg(vals[1]))
# See example 6.2
vals <- eigen(solve(E) %*% H)
sprintf("Eigenvalues: %s", mean(vals[1]))
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)
eigen_mean <- mean(vals)
sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)
eigen_mean <- rowMeans(vals)
# See example 6.2
vals <- eigen(solve(E) %*% H)
eigen_mean <- mean(vals)
# sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)[1]
eigen_mean <- mean(vals)
# sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)[1]
vals
eigen_mean <- mean(vals)
# sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)[1]
vals
typeof(vals)
# sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)[1]
sapply(vals, mean)
# sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
# See example 6.2
vals <- eigen(solve(E) %*% H)[1]
eigen_mean <- sapply(vals, mean)
sprintf("Eigenvalues: %s", eigen_mean)
# The eigenvalues of E^-1H are 2.9515 and .1273.
# The essential dimensionality of the space of the mean vectors is 1.
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
```
```{r}
testdata <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/testscoresdata.txt", header=TRUE)
```{r}
testdata <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/testscoredata.txt", header=TRUE)
testdata.noIDs <- testdata[,-1]  #to remove the ID numbers
testdata <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/testscoredata.txt", header=TRUE)
testdata.noIDs <- testdata[,-1]  #to remove the ID numbers
testdata
testdata <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/testscoredata.txt", header=TRUE)
testdata.noIDs <- testdata[,-1]  #to remove the ID numbers
testdata.noIDs
testdata <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/testscoredata.txt", header=TRUE)
testdata.noIDs <- testdata[,-1]  #to remove the ID numbers
as.data.frame(testdata.noIDs)
summary(manova(cbind(math, reading)~sex), data=restdata.noIDs)
summary(manova(cbind(math, reading)~sex, data=restdata.noIDs))
library(nnspat)  # used for dist2full()
library("dplyr")  # used to select numeric datatypes
library("ggplot2")
library(reshape)  # used for melting matricies
testdata <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/testscoredata.txt", header=TRUE)
testdata.noIDs <- testdata[,-1]  #to remove the ID numbers
as.data.frame(testdata.noIDs)
summary(manova(cbind(math, reading)~sex, data=restdata.noIDs))
summary(manova(cbind(math, reading)~sex, data=testdata.noIDs))
summary(manova(cbind(math, reading)~sex, data=testdata.noIDs, test="Hotelling"))
summary(manova(cbind(math, reading)~sex, data=testdata.noIDs, test="Hotelling"))
summary(manova(cbind(math, reading~sex, data=testdata.noIDs), test="Hotelling"))
summary(manova(cbind(math, reading) ~sex, data=testdata.noIDs), test="Hotelling")
summary(manovaa(cbind(height, jump) ~ sport), data=cbind(sport, height, jump), test="Wilks")
summary(manova(cbind(height, jump) ~ sport), data=cbind(sport, height, jump), test="Wilks")
sport.manova <- manova(cbind(height, jump) ~ sport), data=cbind(sport, height, jump)
sport.manova <- manova(cbind(height, jump) ~ sport), data=cbind(sport, height, jump))
sport.manova <- manova(cbind(height, jump) ~ sport)
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
###############
chisplot(residuals(iris.manova))
sport.manova <- manova(cbind(height, jump) ~ sport)
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
###############
chisplot(residuals(sport.manova))
attach(iris)
iris.manova <- manova(cbind(Sepal.Length, Sepal.Width, Petal.Length,
Petal.Width) ~ Species)
# Doing the MANOVA test using Wilks' Lambda:
summary(iris.manova, test="Wilks")
# Using the other test statistics:
attach(iris)
iris.manova <- manova(cbind(Sepal.Length, Sepal.Width, Petal.Length,
Petal.Width) ~ Species)
# Doing the MANOVA test using Wilks' Lambda:
summary(iris.manova, test="Wilks")
# Using the other test statistics:
summary(iris.manova, test="Roy")
summary(iris.manova, test="Hotelling-Lawley")
summary(iris.manova, test="Pillai")
# We have strong evidence that the mean vectors differ across the 3 species.
# Checking model assumption of normality:
###############
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
###############
chisplot(residuals(iris.manova))
# No strong evidence against normality -- we are safe.
# Examining the sample covariance matrices for each group:
by(iris[,-5], Species, var)
# Is there evidence that the covariance matrices are significantly different
across the 3 species?
attach(iris)
iris.manova <- manova(cbind(Sepal.Length, Sepal.Width, Petal.Length,
Petal.Width) ~ Species)
# Doing the MANOVA test using Wilks' Lambda:
summary(iris.manova, test="Wilks")
# Using the other test statistics:
summary(iris.manova, test="Roy")
summary(iris.manova, test="Hotelling-Lawley")
summary(iris.manova, test="Pillai")
# We have strong evidence that the mean vectors differ across the 3 species.
# Checking model assumption of normality:
###############
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
###############
chisplot(residuals(iris.manova))
# No strong evidence against normality -- we are safe.
# Examining the sample covariance matrices for each group:
by(iris[,-5], Species, var)
# Is there evidence that the covariance matrices are significantly different across the 3 species?
##### Differences in Means for doing Bonferroni multiple comparisons:
means.by.grps <- cbind(tapply(Sepal.Length,Species,mean),
tapply(Sepal.Width,Species,mean), tapply(Petal.Length,Species,mean),
tapply(Petal.Width,Species,mean) )
## The matrix E:
my.n <- nrow(iris[,-5])
E <- (my.n - 1)*var(residuals(iris.manova))
E
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, height, jump)
summary(manova(cbind(height, jump) ~ sport), data=sports, test="Wilks")
sport.manova <- manova(cbind(height, jump) ~ sport)
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
chisplot(residuals(sport.manova))
my.n <- nrow(satmult)  # number of individuals
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
xbar.sports <- apply(sports, 2, mean)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
xbar.sports <- apply(sports, 2, mean)
xbar.sports
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports[-1])
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
sports
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, as.numeric(height), as.numeric(jump))
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, as.numeric(height), as.numeric(jump))
summary(manova(cbind(height, jump) ~ sport), data=sports, test="Wilks")
sport.manova <- manova(cbind(height, jump) ~ sport)
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
chisplot(residuals(sport.manova))
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
sports
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, height, jump)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
sports$2
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colnames(sports)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
typeof(sports)
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- as.matrix(cbind(sport, height, jump))
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
typeof(sports)
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, jump, height)
summary(manova(cbind(height, jump) ~ sport), data=sports, test="Wilks")
sport.manova <- manova(cbind(height, jump) ~ sport)
chisplot <- function(x) {
if (!is.matrix(x)) stop("x is not a matrix")
### determine dimensions
n <- nrow(x)
p <- ncol(x)
xbar <- apply(x, 2, mean)
S <- var(x)
S <- solve(S)
index <- (1:n)/(n+1)
xcent <- t(t(x) - xbar)
di <- apply(xcent, 1, function(x,S) x %*% S %*% x,S)
quant <- qchisq(index,p)
plot(quant, sort(di), ylab = "Ordered distances",
xlab = "Chi-square quantile", lwd=2,pch=1)
}
chisplot(residuals(sport.manova))
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
my.n
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(as.data.frame(sports))
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(as.numeric(sports$height))
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(as.numeric(sports))
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(as.numeric(sports[-1]))
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, jump, height)
sports
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- cbind(sport, jump, height)
sports$jump
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- as.matrix(cbind(sport, jump, height))
sports
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- as.data.frame(cbind(sport, jump, height))
sports
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- as.data.frame(cbind(sport, jump, height))
sports$jump <- as.numeric(sports$jump)
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- as.data.frame(cbind(sport, jump, height))
sports$jump <- as.numeric(sports$jump)
sports
sport <- c('B','B','B','B','B','T','T','T','T','S','S','S','S','S','S')
height <- c(66,65,68,64,67,63,61,62,60,62,65,63,62,63.5,66)
jump<-c(27,29,26,29,29,23,26,23,26,23,21,21,23,22,21.5)
sports <- as.data.frame(cbind(sport, jump, height))
sports$jump <- as.numeric(sports$jump)
sports$height <- as.numeric(sports$height)
sports
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports[,-1])
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports, dims = sport)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports[,-1])
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports[,-1], dims = sport)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
colMeans(sports[,-1])
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
mosaicplot(sports)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
prop.table(sports)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
prop.table(sports, margin=2)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
prop.table(sports, margin=1)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
sports
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
sports %>%
group_by(sport) %>%
summarise_at(vars("jump", "height"), mean)
my.n <- nrow(sports)  # number of individuals
# Sample mean vectors for the SAT scores data:
as.data.frame(
sports %>%
group_by(sport) %>%
summarise_at(vars("jump", "height"), mean)
)
fish <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/T6_17_FISH.DAT", header=TRUE)
as.data.frame(fish)
fish <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/T6_17_FISH.DAT", header=FALSE)
as.data.frame(fish)
fish <- read.table("C:/mattgraham93.github.io/school/22_3_DA410/data/T6_17_FISH.DAT", header=FALSE)
colnames(fish) <- c('method', 'y1', 'y2', 'y3', 'y4')
as.data.frame(fish)
