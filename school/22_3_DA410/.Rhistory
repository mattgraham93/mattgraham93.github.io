ggtitle("Sales by feature and brand") +
theme_modern_rc() +
xlab("")
sold.by.brand.feature %>%
ggplot(aes(fill=brand, y=avg_sold, x=feature)) +
geom_bar(position="stack", stat="identity") +
scale_fill_viridis(discrete = T, option = "E") +
ggtitle("Studying 4 species..") +
facet_wrap(~specie) +
theme_ipsum() +
theme(legend.position="none") +
xlab("")
sold.by.brand.feature %>%
ggplot(aes(fill=brand, y=avg_sold, x=feature)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete = T, option = "E") +
ggtitle("Studying 4 species..") +
facet_wrap(~specie) +
theme_ipsum() +
theme(legend.position="none") +
xlab("")
sold.by.brand.feature %>%
ggplot(aes(fill=brand, y=avg_sold, x=feature)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete = T, option = "E") +
ggtitle("Studying 4 species..") +
facet_wrap(~specie) +
theme_ipsum() +
theme(legend.position="none") +
xlab("")
sold.by.brand.feature %>%
ggplot(aes(fill=brand, y=avg_sold, x=feature)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete = T, option = "E") +
ggtitle("Studying 4 species..") +
facet_wrap(~feature) +
theme_ipsum() +
theme(legend.position="none") +
xlab("")
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
import(plyr)
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
ids <- c(1:11)
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(ids, brands)
brand.map
ids <- c(as.integer(1:11)
brands <- c('Tropicana Premium 64 oz',
ids <- c(as.integer(1:11))
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(ids, brands)
brand.map
ids <- c(as.integer(1:11))
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(strtoi(ids), brands)
brand.map
ids <- c(as.integer(1:11))
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(ids, brands)
brand.map
ids <- c(as.integer(1:11))
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(strtoi(ids, 16L), brands)
brand.map
ids <- c(as.numeric(1:11))
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(ids, brands)
brand.map
ids <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11)
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(ids, brands)
brand.map
ids <- c(as.numeric(1:11))
brands <- c('Tropicana Premium 64 oz',
'Tropicana Premium 96 oz',
'Floridas Natural 64 oz',
'Tropicana 64 oz',
'Minute Maid 64 oz',
'Minute Maid 96 oz',
'Citrus Hill 64 oz',
'Tree Fresh 64 oz',
'Florida Gold 64 oz',
'Dominicks 64 oz',
'Dominicks 128 oz ')
brand.map <- cbind(ids, brands)
brand.map
sold.by.brand.feature %>%
ggplot(aes(fill=brand, y=avg_sold, x=feature)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete = T, option = "E") +
ggtitle("Studying 4 species..") +
facet_wrap(~feature) +
theme_ipsum() +
theme(legend.position="none") +
xlab("")
sold.by.brand.feature %>%
ggplot(aes(fill=brand, y=avg_sold, x=feature)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(continuous = T, option = "E") +
ggtitle("Studying 4 species..") +
facet_wrap(~feature) +
theme_ipsum() +
theme(legend.position="none") +
xlab("")
oj.prices <- orangeJuice$yx
oj.prices
oj.prices$feat[oj.prices$feat > 0] = 1
oj.prices$feat[oj.prices$feat == 1] = "with"
oj.prices$feat[oj.prices$feat == 0] = "without"
oj.prices$logmove = exp(oj.prices$logmove)
unique(oj.prices$feat)
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature==0,]
no.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
feat.model <- aov(avg_sold ~ brand+feature, data=sold.by.brand.feature)
summary(feat.model)
plot(feat.model)
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity")
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ipsum()
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc() +
scale_x_continuous(breaks=seq(1,12,1))
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc() +
scale_x_continuous(breaks=seq(1,11,1))
summary(sold.by.brand.feature)
summary(feature)
summary(no.feature)
summary(no.feature$avg_sold)
summary(feature$avg_sold)
rowmeans(no.feature$avg_sold)
rowMeans(no.feature$avg_sold)
rowMeans(no.feature)
rowMeans(sold.by.brand.feature)
summary(no.feature$avg_sold)
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=brand, y=feature)) +
geom_boxplot()
p
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=brand, y=avg_sold)) +
geom_boxplot()
p
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=feature, y=avg_sold)) +
geom_boxplot()
p
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=feature, y=avg_sold)) +
geom_boxplot() +
theme_ft_rc() +
p
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=feature, y=avg_sold)) +
geom_boxplot() +
theme_ft_rc() +
p
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=brand, y=avg_sold)) +
geom_boxplot() +
p
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=brand, y=avg_sold)) +
geom_boxplot()
p
oj.prices <- orangeJuice$yx
oj.prices
oj.prices$feat[oj.prices$feat > 0] = 1
oj.prices$feat[oj.prices$feat == 1] = "with"
oj.prices$feat[oj.prices$feat == 0] = "without"
oj.prices$logmove = exp(oj.prices$logmove)
oj.prices$brand = as.character(oj.prices$brand)
unique(oj.prices$feat)
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
feat.model <- aov(avg_sold ~ brand+feature, data=sold.by.brand.feature)
summary(feat.model)
plot(feat.model)
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc() +
scale_x_continuous(breaks=seq(1,11,1))
sold.by.brand.feature %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(name = fct_reorder(brand, val)) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(name = fct_reorder(avg_sold, val)) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
install.packages("forcats")
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
sold.by.brand.feature %>%
mutate(name = fct_reorder(avg_sold, val)) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(name = fct_reorder(brand, avg_sold)) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(name = fct_reorder(brand, desc(avg_sold)) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(name = fct_reorder(brand, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
feat.model <- aov(avg_sold ~ brand*feature, data=sold.by.brand.feature)
summary(feat.model)
oj.prices <- orangeJuice$yx
oj.prices
oj.prices$feat[oj.prices$feat > 0] = 1
oj.prices$feat[oj.prices$feat == 1] = "with"
oj.prices$feat[oj.prices$feat == 0] = "without"
oj.prices$logmove = exp(oj.prices$logmove)
oj.prices$brand_ch = as.character(oj.prices$brand)
unique(oj.prices$feat)
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat, oj.prices$brand_ch), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'avg_sold')
sold.by.brand.feature
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat, oj.prices$brand_ch), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'brand_ch', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
data(orangeJuice)
oj.prices <- orangeJuice$yx
oj.prices
oj.prices$feat[oj.prices$feat > 0] = 1
oj.prices$feat[oj.prices$feat == 1] = "with"
oj.prices$feat[oj.prices$feat == 0] = "without"
oj.prices$logmove = exp(oj.prices$logmove)
oj.prices$brand_ch = as.character(oj.prices$brand)
unique(oj.prices$feat)
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat, oj.prices$brand_ch), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'brand_ch', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
feat.model <- aov(avg_sold ~ brand*feature, data=sold.by.brand.feature)
summary(feat.model)
# Basic box plot
p <- ggplot(sold.by.brand.feature, aes(x=brand_ch, y=avg_sold)) +
geom_boxplot()
p
install.packages('hrbrthemes')
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
data(orangeJuice)
oj.prices <- orangeJuice$yx
oj.prices
oj.prices$feat[oj.prices$feat > 0] = 1
oj.prices$feat[oj.prices$feat == 1] = "with"
oj.prices$feat[oj.prices$feat == 0] = "without"
oj.prices$logmove = exp(oj.prices$logmove)
oj.prices$brand_ch = as.character(oj.prices$brand)
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat, oj.prices$brand_ch), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'brand_ch', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
feat.model <- aov(avg_sold ~ brand*feature, data=sold.by.brand.feature)
summary(feat.model)
plot(feat.model)
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_linedraw()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_minimal()
library(bayesm)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(plyr)
library(forcats)
data(orangeJuice)
oj.prices <- orangeJuice$yx
oj.prices
oj.prices$feat[oj.prices$feat > 0] = 1
oj.prices$feat[oj.prices$feat == 1] = "with"
oj.prices$feat[oj.prices$feat == 0] = "without"
oj.prices$logmove = exp(oj.prices$logmove)
oj.prices$brand_ch = as.character(oj.prices$brand)
sold.by.brand.feature <- aggregate(x=oj.prices$logmove, by=list(oj.prices$brand, oj.prices$feat, oj.prices$brand_ch), FUN=mean)
colnames(sold.by.brand.feature) <- c('brand', 'feature', 'brand_ch', 'avg_sold')
sold.by.brand.feature
no.feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="without",]
no.feature
feature <- sold.by.brand.feature[sold.by.brand.feature$feature=="with",]
feature
feat.model <- aov(avg_sold ~ brand*feature, data=sold.by.brand.feature)
summary(feat.model)
plot(feat.model)
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_dark()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_minimal()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_void()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
sold.by.brand.feature %>%
mutate(brand = fct_reorder(brand_ch, desc(avg_sold))) %>%
ggplot(aes(fill=feature, y=avg_sold, x=brand)) +
geom_bar(position="dodge", stat="identity") +
theme_ft_rc()
