objective = cost.vector,
direction = "min")
# prepare summary of the results for the call center problem
ShiftID <- 1:8
StartTime <- c(0,6,8,10,12,2,4,6)
# c("Midnight","6 AM","8 AM","10 AM","Noon","2 PM","4 PM","6 PM")
ShiftDuration <- rep(6,times=8)
HourlyShiftSalary <- c(42,48,30,30,30,48,48,48)
HourlyShiftCost <- call.center.schedule$objective # six x hourly shift salary
Solution <- call.center.schedule$solution
ShiftCost <- call.center.schedule$solution * call.center.schedule$objective
call.center.summary <-
data.frame(ShiftID,StartTime,ShiftDuration,HourlyShiftSalary,
HourlyShiftCost,Solution,ShiftCost)
cat("\n\n","Call Center Summary","\n\n")
print(call.center.summary)
# the solution is obtained by print(call.center.schedule)
# or by summing across the hourly solution times the cost objective
print(call.center.schedule)
cat("\n\n","Call Center Summary Minimum Cost Solution:",sum(ShiftCost),"\n\n")
# build data frame for plotting the solution compared with need
hour <- 1:24  # hour for horizontal axix of line chart
type <- rep("Hourly Need", length = 24)
value <- servers.needed
needs.data.frame <- data.frame(hour, value, type)
type <- rep("Optimal Solution", length = 24)
value <- schedule.fit.to.need <-
constraint.matrix %*% call.center.schedule$solution
solution.data.frame <- data.frame(hour, value, type)
plotting.data.frame <- rbind(needs.data.frame, solution.data.frame)
# plot the solution... solution match to the workforce need
pdf(file = "fig_operations_management_solution.pdf", width = 11, height = 8.5)
heart1("Matt")
# Source: http://statistics.berkeley.edu/classes/s133/heart.r
heart1 = function(name){
t = seq(0,60,len=100)
plot(c(-8,8),c(0,20),type='n',axes=FALSE,xlab='',ylab='')
x = -.01*(-t^2+40*t+1200)*sin(pi*t/180)
y = .01*(-t^2+40*t+1200)*cos(pi*t/180)
lines(x,y, lwd=4)
lines(-x,y, lwd=4)
text(0,7,"Happy Valentine's Day",col='red',cex=2.5)
text(0,5.5,name,col='red',cex=2.5)
}
heart1("Matt")
heart1("Matt!")
write('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', file = "~/.Renviron", append = TRUE)
Sys.which("make")
Sys.which("make")
install.packages("Rstem", repos = "http://www.omegahat.net/R", type = "source")
install.packages("devtools")
install.packages("wordcloud")
install.packages("SnowballC")
install.packages("plyr")
install.packages("ggplot2")
install.packages("RColorBrewer")
install.packages("tm")
require(devtools)
# require(SnowballC)
install_url("https://cran.r-project.org/src/contrib/Archive/sentiment/sentiment_0.1.tar.gz")
install_url("https://cran.r-project.org/src/contrib/Archive/sentiment/sentiment_0.2.tar.gz")
library(plyr)
library(ggplot2)
library(wordcloud)
library(RColorBrewer)
library(tm)
library(SnowballC)
library(sentiment)
textdata = gsub("[[:punct:]]", "", textdata)
data <- readLines("http://www.r-bloggers.com/wp-
content/uploads/2016/01/vent.txt") # from: http://www.wvgazettemail.com/
df <- data.frame(data)
textdata <- df[df$data, ]
textdata = gsub("[[:punct:]]", "", textdata)
textdata
textdata <- df[df$data, ]
###Get the data
data <- readLines("http://www.r-bloggers.com/wp-content/uploads/2016/01/vent.txt")
# from: http://www.wvgazettemail.com/
df <- data.frame(data)
textdata <- df[df$data, ]
textdata
textdata <- df$data
###Get the data
data <- readLines("http://www.r-bloggers.com/wp-content/uploads/2016/01/vent.txt")
# from: http://www.wvgazettemail.com/
df <- data.frame(data)
textdata <- df$data
textdata
textdata <- df$data
textdata = gsub("[[:punct:]]", "", textdata)
textdata = gsub("[[:digit:]]", "", textdata)
textdata = gsub("http\\w+", "", textdata)
textdata = gsub("[ \t]{2,}", "", textdata)
textdata = gsub("^\\s+|\\s+$", "", textdata)
try.error = function(x)
{
y = NA
try_error = tryCatch(tolower(x), error=function(e) e)
if (!inherits(try_error, "error"))
y = tolower(x)
return(y)
}
textdata = sapply(textdata, try.error)
textdata = textdata[!is.na(textdata)]
names(textdata) = NULL
textdata
# textdata
```
textdata = gsub("[[:punct:]]", "", textdata)
textdata = gsub("[[:digit:]]", "", textdata)
textdata = gsub("http\\w+", "", textdata)
textdata = gsub("[ \t]{2,}", "", textdata)
textdata = gsub("^\\s+|\\s+$", "", textdata)
try.error = function(x)
{
y = NA
try_error = tryCatch(tolower(x), error=function(e) e)
if (!inherits(try_error, "error"))
y = tolower(x)
return(y)
}
textdata = sapply(textdata, try.error)
textdata = textdata[!is.na(textdata)]
names(textdata) = NULL
# textdata
sent_df = within(sent_df,
emotion <- factor(emotion, levels=names(sort(table(emotion),
decreasing=TRUE))))
class_emo = classify_emotion(textdata, algorithm="bayes", prior=1.0)
emotion = class_emo[,7]
emotion[is.na(emotion)] = "unknown"
class_pol = classify_polarity(textdata, algorithm="bayes")
polarity = class_pol[,4]
sent_df = data.frame(text=textdata, emotion=emotion,
polarity=polarity, stringsAsFactors=FALSE)
sent_df = within(sent_df,
emotion <- factor(emotion, levels=names(sort(table(emotion),
decreasing=TRUE))))
sent_df
sent_df$emotion
sent_df$polarity
sent_df$emotion
ggplot(sent_df, aes(x=polarity)) +
geom_bar(aes(y=..count.., fill=polarity)) +
scale_fill_brewer(palette="RdGy") +
labs(x="polarity categories", y="")
```{r}
ggplot(sent_df, aes(x=polarity)) +
geom_bar(aes(y=..count.., fill=polarity)) +
scale_fill_brewer(palette="RdGy") +
labs(x="polarity categories", y="")
ggplot(sent_df, aes(x=emotion)) +
geom_bar(aes(y=..count.., fill=emotion)) +
scale_fill_brewer(palette="Dark2") +
labs(x="emotion categories", y="")
install.packages("Rstem", repos = "http://www.omegahat.net/R", type = "source")
install.packages("devtools")
install.packages("wordcloud")
install.packages("SnowballC")
install.packages("plyr")
install.packages("ggplot2")
install.packages("RColorBrewer")
install.packages("tm")
require(devtools)
install_url("https://cran.r-project.org/src/contrib/Archive/sentiment/sentiment_0.1.tar.gz")
install_url("https://cran.r-project.org/src/contrib/Archive/sentiment/sentiment_0.2.tar.gz")
# install.packages("Rstem", repos = "http://www.omegahat.net/R", type = "source")
# install.packages("devtools")
# install.packages("wordcloud")
# install.packages("SnowballC")
# install.packages("plyr")
# install.packages("ggplot2")
# install.packages("RColorBrewer")
# install.packages("tm")
# require(devtools)
# install_url("https://cran.r-project.org/src/contrib/Archive/sentiment/sentiment_0.1.tar.gz")
# install_url("https://cran.r-project.org/src/contrib/Archive/sentiment/sentiment_0.2.tar.gz")
library(plyr)
library(ggplot2)
library(wordcloud)
library(RColorBrewer)
library(tm)
library(SnowballC)
library(sentiment)
emos = levels(factor(sent_df$emotion))
nemo = length(emos)
emo.docs = rep("", nemo)
for (i in 1:nemo)
{
tmp = textdata[emotion == emos[i]]
emo.docs[i] = paste(tmp, collapse=" ")
}
emo.docs = removeWords(emo.docs, stopwords("english"))
corpus = Corpus(VectorSource(emo.docs))
tdm = TermDocumentMatrix(corpus)
tdm = as.matrix(tdm)
colnames(tdm) = emos
comparison.cloud(tdm, colors = brewer.pal(nemo, "Dark2"),
scale = c(3,.5), random.order = FALSE,
title.size = 1.5)
emos = levels(factor(sent_df$emotion))
nemo = length(emos)
emo.docs = rep("", nemo)
for (i in 1:nemo)
{
tmp = textdata[emotion == emos[i]]
emo.docs[i] = paste(tmp, collapse=" ")
}
emo.docs = removeWords(emo.docs, stopwords("english"))
corpus = Corpus(VectorSource(emo.docs))
tdm = TermDocumentMatrix(corpus)
tdm = as.matrix(tdm)
colnames(tdm) = emos
comparison.cloud(tdm, colors = brewer.pal(nemo, "Dark2"),
scale = c(3,.5), random.order = FALSE,
title.size = 1.5)
# install.packages("Rcpp")
# install.packages("aod")
library(aod)
library(ggplot2)
library(Rcpp)
###Get the data
mydata <- read.csv (file="C:/mattgraham93.github.io/school/23_1_DA420/projects/binary.csv")
print(head(mydata))
print(summary(mydata))
print(sapply(mydata, sd))
## we want to make sure there are not 0 cells
xtabs(~ admit + rank, data = mydata)
sapply(mydata, sd)
summary(mydata)
head(mydata)
mylogit <- glm(admit ~ gre + gpa + rank, data = mydata, family = "binomial")
mydata$rank <- factor(mydata$rank)
mylogit <- glm(admit ~ gre + gpa + rank, data = mydata, family = "binomial")
summary(mylogit)
## CIs using profiled log-likelihood
confint(mylogit)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), Terms = 4:6)
## CIs using standard errors
confint.default(mylogit)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), Terms = 4:6)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), L = l)
l <- cbind(0,0,0,1,-1,0)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), L = l)
## odds ratios only
exp(coef(mylogit))
# odds ratios and 95% CI
exp(cbind(OR = coef(mylogit), confint(mylogit)))
# calculate predictive probability of admission for each rank
newdata1 <- with(mydata,
data.frame(gre = mean(gre), gpa = mean(gpa), rank = factor(1:4)))
newdata1
newdata1
newdata1$rankP <- predict(mylogit, newdata = newdata1, type = "response")
newdata1
newdata2 <- with(mydata,
data.frame(gre = rep(seq(from = 200, to = 800, length.out = 100), 4),
gpa = mean(gpa), rank = factor(rep(1:4, each = 100))))
newdata2
head(newdata2)
## view first few rows of final dataset
head(newdata3)
newdata3 <- cbind(newdata2, predict(mylogit, newdata = newdata2, type="link",
se=TRUE))
newdata3 <- within(newdata3, {
PredictedProb <- plogis(fit)
LL <- plogis(fit - (1.96 * se.fit))
UL <- plogis(fit + (1.96 * se.fit))
})
## view first few rows of final dataset
head(newdata3)
ggplot(newdata3, aes(x = gre, y = PredictedProb)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = rank), alpha = .2) +
geom_line(aes(colour = rank), size=1)
with(mylogit, null.deviance - deviance)
with(mylogit, df.null - df.residual)
with(mylogit, pchisq(null.deviance - deviance, df.null - df.residual,
lower.tail = FALSE))
with(mylogit, pchisq(null.deviance - deviance, df.null - df.residual, lower.tail = FALSE))
logLik(mylogit)
logLik(mylogit)
packages('readxl')
package('readxl')
library('readxl')
install.packages("readxl")
library(readxl)
fertil2
getwd()
setwd("~/")
getwd()
setwd("C:/mattgraham93.github.io/school/23_2_ECON400")
fertil2 <- read_excel('fertil2.xls')
fertil2
fertil2
min(fertil2$children)
max(fertil2$children)
subset(fertil2, (electric = 1))
subset(fertil2, electric = 1)
subset(fertil2, electric == 1)
w_elec <- nrow(subset(fertil2, electric == 1))
w_elec
prop_w_elec <- round(w_elec / total, 2)
w_elec <- nrow(subset(fertil2, electric == 1))
total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 2)
prop_w_elec
prop_w_elec <- round(w_elec / total, 4)
w_elec <- nrow(subset(fertil2, electric == 1))
total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
prop_w_elec
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
num_w_elec <- nrow(w_elec)
num_total <- nrow(fertil2)
num_wo_elec <- num_total - num_w_elec
prop_w_elec <- round(w_elec / total, 4)
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
num_w_elec <- nrow(w_elec)
num_total <- nrow(fertil2)
num_wo_elec <- num_total - num_w_elec
prop_w_elec <- round(w_elec / total, 4)
prop_w_elec <- round(w_elec / total, 4)
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
num_w_elec <- nrow(w_elec)
num_total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
/
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
# num_w_elec <- nrow(w_elec)
# num_total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
# wo_elec <- subset(fertil2, electric == 0)
#
# num_w_elec <- nrow(w_elec)
# num_total <- nrow(fertil2)
w_elec <- subset(fertil2, electric == 1)
# wo_elec <- subset(fertil2, electric == 0)
#
# num_w_elec <- nrow(w_elec)
# num_total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
w_elec <- nrow(subset(fertil2, electric == 1))
total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
prop_w_elec
w_elec <- subset(fertil2, electric == 1)
w_elec <- nrow(w_elec)
total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
prop_w_elec
w_elec <- subset(fertil2, electric == 1)
w_elec <- subset(fertil2, electric == 0)
w_elec <- nrow(w_elec)
total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
prop_w_elec
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
w_elec_num <- nrow(w_elec)
total <- nrow(fertil2)
prop_w_elec <- round(w_elec / total, 4)
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
w_elec_num <- nrow(w_elec)
total <- nrow(fertil2)
prop_w_elec <- round(w_elec_num / total, 4)
prop_w_elec
w_elec <- subset(fertil2, electric == 1)
wo_elec <- subset(fertil2, electric == 0)
num_w_elec <- nrow(w_elec)
num_total <- nrow(fertil2)
num_wo_elec <- num_total - num_w_elec
prop_w_elec <- round(w_elec_num / num_total, 4)
prop_w_elec
wo_elec$children
avg(wo_elec$children)
average(wo_elec$children)
mean(wo_elec$children)
median(wo_elec$children)
mean(w_elec$children)
median(w_elec$children)
getwd()
setwd("C:/mattgraham93.github.io/school/23_2_ECON400")
getwd()
setwd("C:/mattgraham93.github.io/school/23_2_ECON400")
sales_intercept <- 118.91
price_coef <- 7.908
advert_coef <- 1.863
se_coef <- 6.35
se_price <- 1.096
se_advert <- 0.683
r2 <- 0.448
SSR <- 1718.943
n=45
k <- 2
price <- 5.5
advert <- 1200
sales <- sales_intercept + (price * price_coef) + (advert * advert_coef)
sales
# sales t statistic for H0: mu=0:
sales_t <- sales_intercept/se_coef
sales_p <- pt(sales_t, n-1)
sales_p
# sales confidence interval:
c <- qt(.975, n-1)
sales_95ci <- c(sales_intercept - c*se_coef, sales_intercept + c*se_coef)
sales_95ci
# price t statistic for H0: mu=0:
price_t <- price/se_coef
price_p <- pt(price_t,n-1)
price_p
# price confidence interval:
price_95ci <- c(price_coef - c*se_price, price_coef + c*se_price)
price_95ci
# advert t statistic for H0: mu=0:
advert_t <- advert/se_coef
advert_p <- pt(advert_t,n-1)
advert_p
# advert confidence interval:
advert_95ci <- c(advert_coef - c*se_advert, advert_coef + c*se_advert)
advert_95ci
SST <- SSR / (1-r2)
SSE <- SST - SSR
f <- SSR / SST
f
adj_r2 <- 1 - (((1-r2) * (n-1)) / (n - k - 1))
adj_r2
# Critical F
qf(p=.05, df1=1, df2=44, lower.tail=FALSE)
# Critical F
qf(p=.05, df1=k-1, df2=n-1, lower.tail=FALSE)
SST <- SSR / (1-r2)
SSE <- SST - SSR
MSR = SSR / (k-1)
MSE = SSE / (n-2)
f <- MSR / MSE
f
setwd("C:/mattgraham93.github.io/school/23_2_ECON400")
library(readxl)
ceosal
ceosal <- read_excel('ceosal2.xls')
ceosal
c(avg(ceosal$salary), avg(ceosal$ceoten))
c(mean(ceosal$salary), mean(ceosal$ceoten))
first_year <- subset(ceosal, ceoten == 0)
first_year
first_year <- subset(ceosal, ceoten == 0)
len(first_year)
first_year <- subset(ceosal, ceoten == 0)
nrow(first_year)
first_year <- subset(ceosal, ceoten == 0)
first_year
# nrow(first_year)
first_year <- subset(ceosal, ceoten == 0)
first_year
nrow(first_year)
subset(ceosal, ceoten == max(tenure))
subset(ceosal, ceoten == max(ceosal$tenure))
subset(ceosal, ceoten == max(ceosal$ceoten))
max_ten <- max(ceosal$ceoten)
subset(ceosal, ceoten == max_ten)
max_ten
charity <- read_excel('charity.xls')
charity
c(mean(charity$gift), (nrows(subset(charity, gift == 0)) / nrows(charity)))
c(mean(charity$gift), (nrow(subset(charity, gift == 0)) / nrow(charity)))
c(mean(charity$mailsyear), min(charity$mailsyear), max(charity$mailsyear))
lm(log(salary) ~ ceoten, data=ceosal)
sal_ten_red <- lm(log(salary) ~ ceoten, data=ceosal)
summary(sal_ten_red)
predict(sal_ten_red, newdata = 1)
predict(sal_ten_red, newdata = c(1)
predict(sal_ten_red, newdata = c(1))
predict(sal_ten_red, newdata = data.frame(c(1)))
predict(sal_ten_red, newdata = data.frame(ceo_ten = c(1)))
predict(sal_ten_red, newdata = data.frame(ceoten = c(1)))
predict(sal_ten_red, newdata = data.frame(ceoten = c(2)))
predict(sal_ten_red, newdata = data.frame(ceoten = c(15)))
sal_ten_red <- lm(lsalary ~ ceoten, data=ceosal)
summary(sal_ten_red)
predict(sal_ten_red, newdata = data.frame(ceoten = c(15)))
predict(sal_ten_red, newdata = data.frame(ceoten = c(1)))
ln(predict(sal_ten_red, newdata = data.frame(ceoten = c(1))))
exp(sal_ten_red, newdata = data.frame(ceoten = c(1))))
exp(predict(sal_ten_red, newdata = data.frame(ceoten = c(1))))
exp(predict(sal_ten_red, newdata = data.frame(ceoten = c(2))))
gift_mailsyr <- lm(gift ~ mailsyear, data=charity)
summary(gift_mailsyr)
predict(gift_mailsyr, newdata = data.frame(mailsyear = c(1)))
predict(gift_mailsyr, newdata = data.frame(mailsyear = c(1,2,3,4,5)))
predict(gift_mailsyr, newdata = data.frame(mailsyear = c(0,1,2,3,4,5)))
predict(gift_mailsyr, newdata = data.frame(mailsyear = c(-1,0,1,2,3,4,5)))
predict(gift_mailsyr, newdata = data.frame(mailsyear = c(0,1,2,3,4,5)))
predict(gift_mailsyr, newdata = data.frame(mailsyear = c(-1, 0,1,2,3,4,5)))
gift_mailsyr <- lm(gift ~ mailsyear, data=charity)
summary(gift_mailsyr)
gift_mailsyr
gift_mailsyr <- lm(gift ~ mailsyear, data=charity)
summary(gift_mailsyr)
gift_mailsyr <- lm(gift ~ mailsyear, data=charity)
summary(gift_mailsyr)
gift_mailsyr
gift_mailsyr <- lm(gift ~ mailsyear, data=charity)
summary(gift_mailsyr)
exp(predict(sal_ten_red, newdata = data.frame(ceoten = c(1))))
